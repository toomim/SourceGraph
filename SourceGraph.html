<script type="statebus">

# (Put your editor in coffeescript mode to edit this file.)
#
# This file implements the SourceGraph app using:
#   • The statebus coffeescript-style UI, instead of the client.js
#   • Statebus to store the state, and send to server on "publish"
#     • Uses the default stateb.us server: state://stateb.us
#     • Hardcodes the source location at state://stateb.us/source/27348234
# 
# You do not need to run a server.  To use the app, just double-click this file
# from your finder, to open it with a file:// url.
#
# To fork it, just copy the file in your finder and give it a new name.  It will
# interoperate with the same state!

dom.BODY = ->
  DIV                          # Container
    width: '100%'
    height: '100%'
    position: 'absolute'
    backgroundColor: 'blue'
    margin: -8
    overflow:'hidden'

    DIV                        # Tab Container
      width: 200
      height: '100%'
      position: 'relative'
      backgroundColor: 'lightblue'
      float: 'left'
      borderRight: 'solid'
      borderRightWidth: 1
      borderColor: 'black'

      for i in [1..3]
        DIV                    # Tab
          height: 20
          position: 'relative'
          backgroundColor: 'green'
          borderBottom: 'solid'
          borderBottomWidth: 1
    
    DIV                        # Panel Container
      width: 400
      height: '100%'
      position: 'relative'
      backgroundColor: 'yellow'
      float: 'left'
      borderRight: 'solid'
      borderRightWidth: 1
      borderColor: 'black'
      overflow: 'hidden'

      DIV                      # Panel
        width: 390
        height: '100%'
        position: 'relative'
        backgroundColor: 'orange'
        float: 'left'
        borderRight: 'solid'
        borderRightWidth: 1

        DIV                    # Metadata Header
          height: 100
          position: 'relative'
          backgroundColor: 'red'
          borderBottom: 'solid'
          borderBottomWidth: 1
          'Metadata Header'

        TEXTAREA
          width: '100%'
          height: 500
          position: 'relative'
          backgroundColor: 'gray'
          borderBottom: 'solid'
          borderBottomWidth: 1
          value: fetch('ui').editor_text
          onChange: (e) ->
            ui = fetch('ui')
            ui.editor_text = e.target.value
            save(ui)

        DIV                    # Publish button
          width: 75
          height: 20
          position: 'relative'
          border: 'solid'
          borderWidth: 1
          backgroundColor: 'white'
          textAlign: 'center'
          onClick: ->
            save({key: '/source/27348234', content: fetch('ui').editor_text})
          'Publish'

</script><script src="https://stateb.us/client6.js"></script>